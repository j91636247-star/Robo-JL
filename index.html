<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Backbone JL ‚Äî Rob√¥ Bac Bo Autom√°tico</title>

<!-- PWA Manifest -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#111111">
<link rel="icon" type="image/png" href="icon.png">

<style>
:root{
  --gold:#ffd700;
  --glass-bg: rgba(18,18,20,0.7);
}
html,body{height:100%;margin:0;padding:0;background:#000;font-family:"Segoe UI",Tahoma,Geneva,Verdana,sans-serif;overflow:hidden}

/* LOGIN */
#login-overlay{
  position:fixed;inset:0;background:rgba(0,0,0,0.95);z-index:1000;display:flex;align-items:center;justify-content:center;
}
#login-box{
  background:linear-gradient(180deg,#111,#222);padding:24px;border-radius:16px;border:2px solid var(--gold);display:flex;flex-direction:column;align-items:center;width:240px;
}
#login-box input{
  width:100%;margin:6px 0;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.1);background:rgba(0,0,0,0.45);color:#fff;font-size:14px;
}
#login-box button{
  margin-top:12px;padding:12px 0;width:100%;border:none;border-radius:12px;background:linear-gradient(180deg,#00bfff,#0066cc);color:#fff;font-weight:700;cursor:pointer;transition:transform .1s ease;
}
#login-box button:active{transform:scale(.97);}

/* IFRAME */
#game-frame{position:absolute;inset:0;width:100%;height:100%;border:0;z-index:1}

/* BOT√ÉO ROB√î MINIMIZADO */
#robot-toggle{
  position:fixed;bottom:60px;left:14px;width:48px;height:48px;border-radius:12px;
  background:linear-gradient(180deg, rgba(24,24,26,0.95), rgba(10,10,12,0.75));
  border:2px solid rgba(212,175,55,0.14);
  box-shadow:0 0 6px #0ff, 0 0 12px #00f, inset 0 0 8px #0ff;
  z-index:40;display:flex;align-items:center;justify-content:center;cursor:pointer;
  transition:transform .14s ease;backdrop-filter: blur(4px) saturate(120%);
}
#robot-toggle:active{transform:translateY(2px) scale(.99);}
#robot-svg{width:40px;height:40px;display:block;border-radius:12px}

/* PAINEL */
.calculator-panel{
  position:fixed;top:0;left:0;width:100%;height:45%;background:var(--glass-bg);
  border-bottom-left-radius:16px;border-bottom-right-radius:16px;border:2px solid rgba(212,175,55,0.14);color:#fff;z-index:39;
  box-shadow:0 12px 40px rgba(0,0,0,0.7);padding:14px;box-sizing:border-box;
  transform:translateY(-100%);opacity:0;pointer-events:none;
  transition:transform .36s cubic-bezier(.2,.9,.2,1),opacity .28s ease;backdrop-filter: blur(8px) saturate(120%);
}
.calculator-panel.open{transform:translateY(0);opacity:1;pointer-events:auto}

/* JL / ROB√î */
#robot-name{
  text-align:center;color:#ff4500;font-size:36px;font-weight:900;font-family:'Impact',sans-serif;
  text-shadow:0 0 4px #fff,0 0 10px #f90,0 0 18px #f00,0 0 28px #ff6600;
  margin-bottom:12px;
  animation:fire 1s infinite alternate;
}
@keyframes fire{
  0%{text-shadow:0 0 4px #fff,0 0 10px #f90,0 0 18px #f00,0 0 28px #ff6600;}
  50%{text-shadow:0 0 6px #fff,0 0 14px #ff0,0 0 22px #f30,0 0 36px #ff6600;}
  100%{text-shadow:0 0 4px #fff,0 0 10px #f90,0 0 18px #f00,0 0 28px #ff6600;}
}

.history{display:flex;flex-wrap:wrap;gap:6px;padding:8px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));min-height:44px;align-items:center;margin-bottom:8px}
.mini-ball{width:26px;height:26px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;border:1px solid rgba(255,255,255,0.04)}

.grid-buttons{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px}
.btn-big{padding:12px;border-radius:12px;border:none;font-weight:800;cursor:pointer;box-shadow:0 6px 18px rgba(0,0,0,0.45)}
.btn-azul{background:linear-gradient(180deg,#00bfff,#0066cc);color:#fff}
.btn-vermelho{background:linear-gradient(180deg,#ff6b6b,#7a0000);color:#fff}
.btn-empate{background:linear-gradient(180deg,#ffd700,#b8860b);color:#fff}
.btn-desfazer{background:linear-gradient(180deg,#444,#222);color:var(--gold)}

.results{margin-top:12px}
.result-card{border-radius:10px;padding:12px;border:1px solid rgba(212,175,55,0.12);background:linear-gradient(180deg, rgba(0,0,0,0.3), rgba(0,0,0,0.45))}

.eye-glow{filter:drop-shadow(0 0 8px rgba(0,198,255,0.9))}
.robot-sway{animation: sway 3.6s ease-in-out infinite}
@keyframes sway{0%{transform:translateY(0) rotate(-2deg)}50%{transform:translateY(2px) rotate(2deg)}100%{transform:translateY(0) rotate(-2deg)}}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="login-overlay">
  <div id="login-box">
    <input id="loginUser" type="text" placeholder="Digite o login"/>
    <button onclick="checkLogin()">Entrar</button>
  </div>
</div>

<!-- IFRAME -->
<iframe id="game-frame" src="https://7games.bet.br/pb/casino/slots/-1?openGames=420012128-real&gameNames=Bac%20Bo" sandbox="allow-same-origin allow-scripts allow-popups allow-forms"></iframe>

<!-- BOT√ÉO ROB√î MINIMIZADO -->
<div id="robot-toggle" aria-label="Abrir Backbone JL" title="Backbone JL ‚Äî abrir calculadora" role="button" tabindex="0">
  <svg id="robot-svg" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg" class="robot-sway" aria-hidden="true">
    <defs>
      <linearGradient id="g-metal" x1="0" x2="1" y1="0" y2="1"><stop offset="0" stop-color="#2b2f36"/><stop offset="1" stop-color="#101215"/></linearGradient>
      <linearGradient id="g-gold" x1="0" x2="1"><stop offset="0" stop-color="#ffd966"/><stop offset="1" stop-color="#d4af37"/></linearGradient>
      <radialGradient id="g-eye" cx="50%" cy="50%" r="50%"><stop offset="0" stop-color="#8ef0ff"/><stop offset="1" stop-color="#00a6ff"/></radialGradient>
    </defs>
    <ellipse cx="60" cy="100" rx="20" ry="6" fill="#000" opacity="0.28"/>
    <rect x="26" y="36" rx="10" ry="10" width="68" height="54" fill="url(#g-metal)"/>
    <rect x="38" y="50" rx="6" ry="6" width="44" height="20" fill="url(#g-gold)"/>
    <text id="robot-text" x="60" y="65" font-size="9" font-weight="800" text-anchor="middle" fill="#071018">JL</text>
    <rect x="38" y="18" rx="8" ry="8" width="44" height="28" fill="url(#g-metal)"/>
    <g class="eye-glow">
      <circle cx="50" cy="32" r="4.4" fill="url(#g-eye)"><animate attributeName="r" values="4.2;5.2;4.2" dur="1.6s" repeatCount="indefinite"/><animate attributeName="opacity" values="1;0.75;1" dur="1.6s" repeatCount="indefinite"/></circle>
      <circle cx="70" cy="32" r="4.4" fill="url(#g-eye)"><animate attributeName="r" values="4.2;5.2;4.2" dur="1.6s" begin="0.3s" repeatCount="indefinite"/><animate attributeName="opacity" values="1;0.75;1" dur="1.6s" begin="0.3s" repeatCount="indefinite"/></circle>
    </g>
  </svg>
</div>

<!-- PAINEL -->
<div class="calculator-panel" id="calculatorPanel">
  <div id="robot-name">JL</div>
  <div id="historyContainer" class="history"></div>
  <div class="grid-buttons">
    <button class="btn-big btn-azul" onclick="addColor('azul')">Azul</button>
    <button class="btn-big btn-vermelho" onclick="addColor('vermelho')">Vermelho</button>
    <button class="btn-big btn-empate" onclick="addColor('empate')">Empate</button>
    <button class="btn-big btn-desfazer" onclick="undoColor()">Desfazer</button>
  </div>
  <div class="results" id="results"></div>
</div>

<script>
// LOGIN
function checkLogin(){
  const user=document.getElementById('loginUser').value;
  if(user==='123'){document.getElementById('login-overlay').style.display='none';}
  else{alert('Login incorreto');}
}

// ROB√î TOGGLE
const robotToggle=document.getElementById('robot-toggle');
const calcPanel=document.getElementById('calculatorPanel');
const robotText=document.getElementById('robot-text');
let panelOpen=false;
let robotMode=false;

robotToggle.addEventListener('click',()=>{
  panelOpen?(calcPanel.classList.remove('open'),panelOpen=false):(calcPanel.classList.add('open'),panelOpen=true);
  if(!robotMode){robotText.textContent='ü§ñ';robotMode=true;}
});

// HIST√ìRICO
let seq=[];
const historyContainer=document.getElementById('historyContainer');
const resultsEl=document.getElementById('results');

function renderHistory(){
  historyContainer.innerHTML='';
  seq.forEach((c,idx)=>{
    const b=document.createElement('div');
    b.className='mini-ball';
    if(c==='azul') b.style.background='radial-gradient(circle at 30% 30%,#3bf,#003366)';
    else if(c==='vermelho') b.style.background='radial-gradient(circle at 30% 30%,#ff4444,#660000)';
    else if(c==='empate') b.style.background='radial-gradient(circle at 30% 30%,#ffd700,#b8860b)';
    b.dataset.index=idx;
    b.onclick=()=>{ seq.splice(idx,1); renderHistory(); calcAll(); };
    historyContainer.appendChild(b);
  });
}
function addColor(c){ seq.push(c); renderHistory(); calcAll(); }
function undoColor(){ seq.pop(); renderHistory(); calcAll(); }

// L√ìGICA H√çBRIDA AUTOM√ÅTICA + ADICIONAR AO HIST√ìRICO
function countFollowing(seqArr, pattern){
  const n=pattern.length;
  const follow={azul:0,vermelho:0,empate:0};
  if(n===0||seqArr.length<=n) return follow;
  for(let i=0;i<=seqArr.length-n-1;i++){
    let ok=true;
    for(let j=0;j<n;j++){ if(seqArr[i+j]!==pattern[j]){ ok=false; break; } }
    if(ok){ const next=seqArr[i+n]; if(follow[next]!==undefined) follow[next]++; }
  }
  return follow;
}
function laplace(k,n){ return (k+1)/(n+3); }
function pct(x){ return (x*100).toFixed(1)+'%'; }

function calcAll(){
  const maxPattern=5;
  if(seq.length<2){ resultsEl.innerHTML='<p style="text-align:center;color:#ddd">Hist√≥rico muito curto.</p>'; return; }

  let probs={azul:0,vermelho:0,empate:0};
  for(let len=1;len<=Math.min(maxPattern,seq.length-1);len++){
    const tail=seq.slice(-len);
    const follow=countFollowing(seq,tail);
    const total=follow.azul+follow.vermelho+follow.empate;
    if(total>0){
      let weight=len;
      probs.azul += laplace(follow.azul,total)*weight;
      probs.vermelho += laplace(follow.vermelho,total)*weight;
      probs.empate += laplace(follow.empate,total)*weight;
    }
  }
  const sum=probs.azul+probs.vermelho+probs.empate;
  for(let k in probs) probs[k]/=sum;

  let rec='‚Äî';
  for(let c of ['azul','vermelho','empate']){
    if(probs[c]>=0.98){ rec=c; break; }
  }

  // ADICIONA AUTOMATICAMENTE AO HIST√ìRICO
  if(rec !== '‚Äî' && seq[seq.length-1] !== rec){
    seq.push(rec);
    renderHistory();
  }

  resultsEl.innerHTML=`
    <div class="result-card">
      <div style="display:flex;height:12px;border-radius:8px;overflow:hidden;border:1px solid rgba(212,175,55,0.12);">
        <div style="flex:${probs.azul};background:linear-gradient(90deg,#00c6ff,#0044cc)"></div>
        <div style="flex:${probs.vermelho};background:linear-gradient(90deg,#ff4b4b,#7a0000)"></div>
        <div style="flex:${probs.empate};background:linear-gradient(90deg,#ffd700,#b8860b)"></div>
      </div>
      <p style="margin:8px 0 0 0;color:#eee;text-align:center;">
        ${pct(probs.azul)} Azul ¬∑ ${pct(probs.vermelho)} Vermelho ¬∑ ${pct(probs.empate)} Empate
      </p>
      <div style="display:flex;justify-content:center;gap:8px;margin-top:10px;">
        <div style="width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;color:#fff;background:radial-gradient(circle at 30% 30%,#3bf,#003366)">${rec==='azul'?'A':''}</div>
        <div style="width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;color:#fff;background:radial-gradient(circle at 30% 30%,#ff4444,#660000)">${rec==='vermelho'?'V':''}</div>
        <div style="width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:bold;color:#fff;background:radial-gradient(circle at 30% 30%,#ffd700,#b8860b)">${rec==='empate'?'E':''}</div>
      </div>
    </div>`;
}

setInterval(calcAll,25000);
</script>
</body>
</html>
